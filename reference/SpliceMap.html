<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Interface to SpliceMap — SpliceMap • Rbowtie</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Interface to SpliceMap — SpliceMap" />
<meta property="og:description" content="The following function can be used to call the SpliceMap binaries.
We recommend to use the QuasR package instead of using SpliceMap directly. QuasR provides a simpler interface than SpliceMap and covers the whole analysis workflow of typical ultra-high throughput sequencing experiments, starting from the raw sequence reads, over pre-processing and alignment, up to quantification." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rbowtie</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.31.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Rbowtie-Overview.html">An introduction to Rbowtie</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/fmicompbio/Rbowtie/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Interface to SpliceMap</h1>
    
    <div class="hidden name"><code>SpliceMap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The following function can be used to call the SpliceMap binaries.</p>
<p>We recommend to use the <span class="pkg">QuasR</span> package instead of using <code>SpliceMap</code> directly. <span class="pkg">QuasR</span> provides a simpler interface than <code>SpliceMap</code> and covers the whole analysis workflow of typical ultra-high throughput sequencing experiments, starting from the raw sequence reads, over pre-processing and alignment, up to quantification.</p>
    </div>

    <pre class="usage"><span class='fu'>SpliceMap</span><span class='op'>(</span><span class='va'>cfg</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>cfg</th>
      <td><p>A list containing named elements with SpliceMap parameters
    (see sQuoteDetails or SpliceMap documentation).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    

<p>The <code>SpliceMap</code> function performes the same steps as the
  <code>runSpliceMap</code> binary from the <em>SpliceMap</em> software package,
  but using <code>R</code> functions to improve compatibility on Windows.</p>
<p>While the original <em>SpliceMap</em> software package is able to call
  different tools to find sub-read alignments, the <code>SpliceMap</code>
  function from the <code>Rbowtie</code> package works only with <code>bowtie</code>
  contained in the package itself. Further modifications from the
  original version include the reporting of unmapped reads at the end of
  the output sam file, and the restriction to a single (pair) of input
  sequence file(s).</p>  
<p>The <code>cfg</code> argument is a list with <em>SpliceMap</em> configuration
  parameters that would normally be specified using the <em>SpliceMap</em>
  configuration file. Here is a list of supported parameters extracted
  from the sample config file that is distributed with <em>SpliceMap</em>:</p>
<p></p><ul>
<li><p><code>genome_dir</code> (single character value)
    Directory of the chromosome files in FASTA format, or path to a
    single FASTA file containing all chromosomes. If a directory, each chromosome
    can be in a separate file or chromosomes can be concatenated, ie. chr1.fa, chr2.fa, ...</p></li>
<li><p><code>reads_list1</code> and <code>reads_list2</code> (single character values)
    These are the two input sequence files. <code>reads_list2</code> can be
    missing if reads are not paired-end. Note: <code>reads_list1</code> must
    be the first pair, and pair-reads should be in the
    &#8220;forward-reverse&#8221; format.</p></li>
<li><p><code>read_format</code> (single character value)
    Format of the sequencer reads, also make sure reads are  not split
    over multiple lines. Choices are: <code>FASTA</code>, <code>FASTQ</code>, <code>RAW</code></p></li>
<li><p><code>quality_format</code> (single character value)
    Format of the quality string if FASTQ is used. Choices are:</p><ul>
<li><p><code>phred-33</code> Phred base 33 (same as Sanger format)</p></li>
<li><p><code>phred-64</code> Phred base 64 (same as Illumina 1.3+)</p></li>
<li><p><code>solexa</code> Format used by solexa machines</p></li>
</ul></li>
<li><p><code>outfile</code> (single character value)
    Name of the output file (spliced alignments in SAM format). If a
    file with this name already exists, <code>SpliceMap</code> will stop with
    an exception. Note that unmapped reads will be appended to the end
    of the output file (for paired-end experiments, only pairs without
    alignments for any read are considered unmapped).</p></li>
<li><p><code>temp_path</code> (single character value)
    Directory name of the directory that stores temporary files. All
    temporary files will be created in a subfolder of
    <code>temp_path</code> and will be removed when <code>SpliceMap</code> finishes
    successfully or failed at an intermediate step.</p></li>
<li><p><code>max_intron</code> (single integer value)
    Maximum intron size, this is absolute 99th-percentile
    maximum. Introns beyond this size will be ignored. If you don't set
    this, we will assume a mamalian genome (400,000)</p></li>
<li><p><code>min_intron</code> (single integer value)
    25-th intron size, this is the lower 25th-percentile intron
    size. This is not the smallest size that SpliceMap will search. That
    is about ~25bp. If you don't set this, we will assume a mammalian
    genome (20,000)</p></li>
<li><p><code>max_multi_hit</code> (single integer value)
    Maximum number of multi-hits. If a 25-mer seed has more than this
    many multi-hits, it will be discarded.  Default is 10.</p></li>
<li><p><code>full_read_length</code> (single integer value)
    Full read length. SpliceMap will only use the first
    &#8220;full_read_length&#8221; bp for mapping. If the read is shorter
    than &#8220;full_read_length&#8221;, the full read will be used before
    head clip.  If you don't set this parameter, SpliceMap will use as
    many as possible. This is for the case where the reads might have
    N's at the end.  It is always desireable to cut off the N's</p></li>
<li><p><code>head_clip_length</code> (single integer value)
    Number of bases to clip off the head of the read. This clipping is
    applied after &#8220;full_read_length&#8221;</p></li>
<li><p><code>seed_mismatch</code> (single integer value)
    Number of mismatches allowed in half-seeding. Choices are
    0,1(default) or 2</p></li>
<li><p><code>read_mismatch</code> (single integer value)
    Maximum number of mismatches allowed in entire read. No limit on
    value, however SpliceMap can only identify reads with a maximum of 2
    mismatches per 25bp.  Default is 2.</p></li>
<li><p><code>max_clip_allowed</code> (single integer value)
    Maximum number of bases allowed to be soft clipped from the ends of
    reads during alignment. This is required as mismatches near
    junctions could cause parts of a a read to not map.  Default is 40.</p></li>
<li><p><code>num_chromosome_together</code> (single integer value)
    Number of chromosomes to process at once, to take advantage of
    multi-core systems. The child processes are created using the
    <code><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></code> function from the <span class="pkg">parallel</span>
    package. This is not threading, so it will take extra
    memory. However, running 2 at a time should be fine on current
    hardware. Default = 2</p></li>
<li><p><code>bowtie_base_dir</code> (single character value)
    Base of bowtie index, this should be the same genome as the
    chromosome files eg. if you bowtie files are
    &#8220;genome/hg18/genome.1.ewbt&#8221;, ... then your base dir is
    &#8220;genome/hg18/genome&#8221;</p></li>
<li><p><code>num_threads</code> (single integer values)
    Number of threads to use for <code>bowtie</code> mapping. Default value is 2</p></li>
<li><p><code>try_hard</code> (single character value)
    Try hard? Choices are &#8220;yes&#8221; or &#8220;no&#8221;.  Default value is
    &#8220;yes&#8221; (about 15% slower).</p></li>
<li><p><code>selectSingleHit</code> (single logical value)
    If <code>TRUE</code> and multiple alignments are found for a read (pair),
    only a single alignment is selected randomly and reported. This is a
    new paramater only available in the <code>R</code> version of
    <code>SpliceMap</code>, but not in the original implementation that could
    report several alignments per read (pair).</p></li>
</ul>

<p>The following parameters are mandatory:</p><ul>
<li><p><code>genome_dir</code></p></li>
<li><p><code>reads_list1</code> (<code>reads_list2</code> for paired-end experiments)</p></li>
<li><p><code>read_format</code></p></li>
<li><p><code>quality_format</code></p></li>
<li><p><code>bowtie_base_dir</code></p></li>
<li><p><code>outfile</code></p></li>
<li><p><code>temp_path</code></p></li>
<li><p><code>num_threads</code></p></li>
<li><p><code>quality_format</code></p></li>
<li><p><code>selectSingleHit</code></p></li>
</ul>
  

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An invisible character vector of length one with the file name of the
  generated output SAM file.</p>
<p>An exception is thrown if a failure is detected at one of the many steps.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Au KF, Jiang H, Lin L, Xing Y, Wong WH. <em>Detection of splice
    junctions from paired-end RNA-seq data by SpliceMap</em>. Nucleic Acids
    Research, 38(14):4570-8 (2010).</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Michael Stadler</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></code> from package <span class="pkg">parallel</span></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Building a bowtie index</span>
<span class='va'>refDir</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>package<span class='op'>=</span><span class='st'>"Rbowtie"</span>, <span class='st'>"samples"</span>, <span class='st'>"refs"</span><span class='op'>)</span>
<span class='va'>indexDir</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"refsIndex"</span><span class='op'>)</span>

<span class='va'>tmp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='bowtie_build.html'>bowtie_build</a></span><span class='op'>(</span>references<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>dir</a></span><span class='op'>(</span><span class='va'>refDir</span>, full<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>, outdir<span class='op'>=</span><span class='va'>indexDir</span>, prefix<span class='op'>=</span><span class='st'>"index"</span>, force<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'>## Alignments</span>
<span class='va'>readsFiles</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span>package<span class='op'>=</span><span class='st'>"Rbowtie"</span>, <span class='st'>"samples"</span>, <span class='st'>"reads"</span>, <span class='st'>"reads.fastq"</span><span class='op'>)</span>
<span class='va'>samFiles</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"splicedAlignments.sam"</span><span class='op'>)</span>

<span class='va'>cfg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>genome_dir<span class='op'>=</span><span class='va'>refDir</span>,
            reads_list1<span class='op'>=</span><span class='va'>readsFiles</span>,
            read_format<span class='op'>=</span><span class='st'>"FASTQ"</span>,
            quality_format<span class='op'>=</span><span class='st'>"phred-33"</span>,
            outfile<span class='op'>=</span><span class='va'>samFiles</span>,
            temp_path<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>,
            max_intron<span class='op'>=</span><span class='fl'>400000</span>,
            min_intron<span class='op'>=</span><span class='fl'>20000</span>,
            max_multi_hit<span class='op'>=</span><span class='fl'>10</span>,
            seed_mismatch<span class='op'>=</span><span class='fl'>1</span>,
            read_mismatch<span class='op'>=</span><span class='fl'>2</span>,
            num_chromosome_together<span class='op'>=</span><span class='fl'>2</span>,
            bowtie_base_dir<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span><span class='op'>(</span><span class='va'>indexDir</span>, <span class='st'>"index"</span><span class='op'>)</span>,
            num_threads<span class='op'>=</span><span class='fl'>4</span>,
            try_hard<span class='op'>=</span><span class='st'>"yes"</span>,
            selectSingleHit<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
            
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>SpliceMap</span><span class='op'>(</span><span class='va'>cfg</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>[SpliceMap] splitting reads into 25mers...</span></div><div class='output co'>#&gt; <span class='message'>done</span></div><div class='output co'>#&gt; <span class='message'>[SpliceMap] aligning 25mers...</span></div><div class='output co'>#&gt; <span class='message'>done</span></div><div class='output co'>#&gt; <span class='message'>[SpliceMap] sorting 25mer-alignments...</span></div><div class='output co'>#&gt; <span class='message'>done</span></div><div class='output co'>#&gt; <span class='message'>[SpliceMap] indexing 25mer-alignments...</span></div><div class='output co'>#&gt; <span class='message'>done</span></div><div class='output co'>#&gt; <span class='message'>[SpliceMap] finding spliced alignments for 3 chromosomes using 2 parallel processes...</span></div><div class='output co'>#&gt; <span class='message'>done</span></div><div class='output co'>#&gt; <span class='message'>[SpliceMap] extracting unmapped reads (single read mode)...</span></div><div class='output co'>#&gt; <span class='message'>done</span></div><div class='output co'>#&gt; <span class='message'>[SpliceMap] combining spliced alignments...</span></div><div class='output co'>#&gt; <span class='message'>done</span></div><div class='output co'>#&gt; <span class='message'>[SpliceMap] reordering final output...</span></div><div class='output co'>#&gt; <span class='message'>done</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Michael Stadler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


